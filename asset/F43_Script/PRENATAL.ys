{"NAME":"PRENATAL","LASTUPDATE":"20190719111910","SQLSCRIPT":" select * from (SELECT  '[#HOSCODE]' HOSPCODE,  RIGHT(CONCAT('000000',a.person_id),6) PID,  a.preg_no GRAVIDA,  CAST(a.lmp AS UNSIGNED) LMP,  CAST(a.edc AS UNSIGNED) EDC,  IF(a.blood_vdrl2_result IS NULL OR a.blood_vdrl2_result ='', IF(a.blood_vdrl1_result LIKE '%ผิด%' OR a.blood_vdrl1_result LIKE '%pos%' OR a.blood_vdrl1_result = '2' ,2,IF(a.blood_vdrl1_result IS NULL OR a.blood_vdrl1_result='' OR a.blood_vdrl1_result LIKE '%รอ%' OR a.blood_vdrl1_result='9',9,1)) , IF(a.blood_vdrl2_result LIKE '%ผิด%' OR a.blood_vdrl2_result LIKE '%pos%' OR a.blood_vdrl2_result = '2' ,2,IF(a.blood_vdrl2_result LIKE '%รอ%' OR a.blood_vdrl2_result='9',9,1)) ) VDRL_RESULT,  IF(a.blood_of_result LIKE '%ผิด%' OR a.blood_of_result LIKE '%pos%' OR a.blood_of_result = '2' ,2,IF(a.blood_of_result IS NULL OR a.blood_of_result='' OR a.blood_of_result LIKE '%รอ%' OR a.blood_of_result='9',9,1)) HB_RESULT,  IF(a.blood_hiv2_result IS NULL OR a.blood_hiv2_result ='', IF(a.blood_hiv1_result LIKE '%ผิด%' OR a.blood_hiv1_result LIKE '%pos%' OR a.blood_hiv1_result = '2' ,2,IF(a.blood_hiv1_result IS NULL OR a.blood_hiv1_result='' OR a.blood_hiv1_result LIKE '%รอ%' OR a.blood_hiv1_result='9',9,1)) , IF(a.blood_hiv2_result LIKE '%ผิด%' OR a.blood_hiv2_result LIKE '%pos%' OR a.blood_hiv2_result = '2' ,2,IF(a.blood_hiv2_result LIKE '%รอ%' OR a.blood_hiv2_result='9',9,1)) ) HIV_RESULT,   ( SELECT CAST(pas1.anc_service_date AS UNSIGNED) FROM person_anc_service pas1 LEFT JOIN person_anc_lab pal1 on pal1.person_anc_service_id = pas1.person_anc_service_id LEFT JOIN anc_lab al1 on al1.anc_lab_id = pal1.anc_lab_id where pas1.person_anc_id = a.person_anc_id and al1.anc_lab_code like 'HCT%'  ORDER BY pas1.anc_service_date desc limit 1 )  DATE_HCT,  ( SELECT CAST(pal1.anc_lab_result AS UNSIGNED) FROM person_anc_service pas1 LEFT JOIN person_anc_lab pal1 on pal1.person_anc_service_id = pas1.person_anc_service_id LEFT JOIN anc_lab al1 on al1.anc_lab_id = pal1.anc_lab_id where pas1.person_anc_id = a.person_anc_id and al1.anc_lab_code like 'HCT%'  ORDER BY pas1.anc_service_date desc limit 1 ) HCT_RESULT,  IFNULL(t.thalassaemia_result_export,9) THALASSEMIA, CAST(a.last_update AS UNSIGNED) D_UPDATE, IFNULL(vn.doctor,'[#DOCTOR]') PROVIDER, p.cid CID  FROM person_anc a   LEFT JOIN person p ON p.person_id = a.person_id   LEFT JOIN person_anc_service pas ON pas.person_anc_id = a.person_anc_id AND pas.anc_service_date = a.dental_tx_date LEFT JOIN person_anc_screen pasc ON pasc.person_anc_service_id = pas.person_anc_service_id  LEFT JOIN person_anc_labor_detail pa ON pa.person_anc_id = a.person_anc_id   LEFT JOIN thalassaemia_result t ON t.thalassaemia_result_id = a.thalassaemia_result_id  LEFT JOIN ovst vn on vn.vn=pas.vn  WHERE DATE(a.last_update)>='[#DATE_START]')p WHERE p.DATE_HCT between '[#DATE_START_T]' and '[#DATE_END_T]' ORDER BY DATE_HCT"}