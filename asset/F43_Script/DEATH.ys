{"NAME":"DEATH","LASTUPDATE":"20190718194127","SQLSCRIPT":" SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',p.person_id),6) PID, IF(p1.death_hospcode IS NULL OR p1.death_hospcode='','00000',p1.death_hospcode) HOSPDEATH, i.an AN, q.seq_id SEQ, CAST(p1.death_date AS UNSIGNED) DDEATH, p1.death_diag_1 CDEATH_A, p1.death_diag_2 CDEATH_B, p1.death_diag_3 CDEATH_C, p1.death_diag_4 CDEATH_D, p1.odisease ODISEASE, p1.death_diag_1 CDEATH, IF(p.sex=1,'4',IF(p1.nopreg='Y',IF(p1.death_preg_42_day IS NULL OR p1.death_preg_42_day OR p1.death_preg_42_day='N',1,2),IF(p1.nopreg='N',3,9))) PREGDEATH, p1.death_place PDEATH, p1.death_cert_doctor PROVIDER, CAST(p1.last_update AS UNSIGNED) D_UPDATE, p.cid CID FROM  person_death p1   INNER JOIN person p ON p1.person_id = p.person_id   LEFT OUTER JOIN ipt i on i.hn = p.patient_hn and i.dchtype in ('08','09') LEFT OUTER JOIN ovst_seq q ON q.vn = i.vn  LEFT OUTER JOIN rpt_504_name r on r.id=p1.death_cause WHERE p1.death_date IS NOT NULL AND p1.death_diag_1 IS NOT NULL AND p1.death_diag_1<>'' AND (p1.death_diag_2 is null or p1.death_diag_2='') AND (p1.death_diag_3 is null or p1.death_diag_3='') AND (p1.death_diag_4 is null or p1.death_diag_4='')  UNION SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',p.person_id),6) PID, IF(p1.death_hospcode IS NULL OR p1.death_hospcode='','00000',p1.death_hospcode) HOSPDEATH, i.an AN, q.seq_id SEQ, CAST(p1.death_date AS UNSIGNED) DDEATH, p1.death_diag_1 CDEATH_A, p1.death_diag_2 CDEATH_B, p1.death_diag_3 CDEATH_C, p1.death_diag_4 CDEATH_D, p1.odisease ODISEASE, p1.death_diag_2 CDEATH, IF(p.sex=1,'4',IF(p1.nopreg='Y',IF(p1.death_preg_42_day IS NULL OR p1.death_preg_42_day OR p1.death_preg_42_day='N',1,2),IF(p1.nopreg='N',3,9))) PREGDEATH, p1.death_place PDEATH, p1.death_cert_doctor PROVIDER, CAST(p1.last_update AS UNSIGNED) D_UPDATE, p.cid CID FROM  person_death p1   INNER JOIN person p ON p1.person_id = p.person_id   LEFT OUTER JOIN ipt i on i.hn = p.patient_hn and i.dchtype in ('08','09') LEFT OUTER JOIN ovst_seq q ON q.vn = i.vn  LEFT OUTER JOIN rpt_504_name r on r.id=p1.death_cause WHERE p1.death_date IS NOT NULL AND p1.death_diag_2 IS NOT NULL AND p1.death_diag_2<>'' AND (p1.death_diag_3 is null or p1.death_diag_3='') AND (p1.death_diag_4 is null or p1.death_diag_4='')  UNION SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',p.person_id),6) PID, IF(p1.death_hospcode IS NULL OR p1.death_hospcode='','00000',p1.death_hospcode) HOSPDEATH, i.an AN, q.seq_id SEQ, CAST(p1.death_date AS UNSIGNED) DDEATH, p1.death_diag_1 CDEATH_A, p1.death_diag_2 CDEATH_B, p1.death_diag_3 CDEATH_C, p1.death_diag_4 CDEATH_D, p1.odisease ODISEASE, p1.death_diag_3 CDEATH, IF(p.sex=1,'4',IF(p1.nopreg='Y',IF(p1.death_preg_42_day IS NULL OR p1.death_preg_42_day OR p1.death_preg_42_day='N',1,2),IF(p1.nopreg='N',3,9))) PREGDEATH, p1.death_place PDEATH, p1.death_cert_doctor PROVIDER, CAST(p1.last_update AS UNSIGNED) D_UPDATE, p.cid CID FROM  person_death p1   INNER JOIN person p ON p1.person_id = p.person_id   LEFT OUTER JOIN ipt i on i.hn = p.patient_hn and i.dchtype in ('08','09') LEFT OUTER JOIN ovst_seq q ON q.vn = i.vn  LEFT OUTER JOIN rpt_504_name r on r.id=p1.death_cause WHERE p1.death_date IS NOT NULL AND p1.death_diag_3 IS NOT NULL AND p1.death_diag_3<>'' AND (p1.death_diag_4 is null or p1.death_diag_4='') AND (p1.death_diag_2 is null or p1.death_diag_2='')  UNION SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',p.person_id),6) PID, IF(p1.death_hospcode IS NULL OR p1.death_hospcode='','00000',p1.death_hospcode) HOSPDEATH, i.an AN, q.seq_id SEQ, CAST(p1.death_date AS UNSIGNED) DDEATH, p1.death_diag_1 CDEATH_A, p1.death_diag_2 CDEATH_B, p1.death_diag_3 CDEATH_C, p1.death_diag_4 CDEATH_D, p1.odisease ODISEASE, p1.death_diag_4 CDEATH, IF(p.sex=1,'4',IF(p1.nopreg='Y',IF(p1.death_preg_42_day IS NULL OR p1.death_preg_42_day OR p1.death_preg_42_day='N',1,2),IF(p1.nopreg='N',3,9))) PREGDEATH, p1.death_place PDEATH, p1.death_cert_doctor PROVIDER, CAST(p1.last_update AS UNSIGNED) D_UPDATE, p.cid CID FROM  person_death p1   INNER JOIN person p ON p1.person_id = p.person_id   LEFT OUTER JOIN ipt i on i.hn = p.patient_hn and i.dchtype in ('08','09') LEFT OUTER JOIN ovst_seq q ON q.vn = i.vn  LEFT OUTER JOIN rpt_504_name r on r.id=p1.death_cause WHERE p1.death_date IS NOT NULL AND p1.death_diag_4 IS NOT NULL AND p1.death_diag_4<>'' ORDER BY DDEATH"}