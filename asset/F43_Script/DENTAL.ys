{"NAME":"DENTAL","LASTUPDATE":"20190718194342","SQLSCRIPT":" SELECT * FROM (SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',q.pcu_person_id),6) PID, q.seq_id SEQ, DATE_FORMAT(o.vstdate,'%Y%m%d') DATE_SERV, d.dental_care_type_id DENTTYPE, IF(d.dental_care_service_place_type_id='' OR d.dental_care_service_place_type_id IS NULL,1,d.dental_care_service_place_type_id) SERVPLACE, IFNULL(d.pteeth,0) PTEETH, IFNULL(d.pcaries,0) PCARIES, IFNULL(d.pfilling,0) PFILLING, IFNULL(d.pextract,0) PEXTRACT, IFNULL(d.dteeth,0) DTEETH, IFNULL(d.dcaries,0) DCARIES, IFNULL(d.dfilling,0) DFILLING, IFNULL(d.dextract,0) DEXTRACT, IF(d.need_fluoride='Y',1,IF(d.need_fluoride='N',2,IF(d.need_fluoride is null,2,d.need_fluoride))) NEED_FLUORIDE, IF(d.need_scaling='Y',1,IF(d.need_scaling='N',2,IF(d.need_scaling is null,2,d.need_scaling))) NEED_SCALING, IFNULL(d.need_sealant,0) NEED_SEALANT, IFNULL(d.need_pfilling,0) NEED_PFILLING, IFNULL(d.need_dfilling,0) NEED_DFILLING, IFNULL(d.need_pextract,0) NEED_PEXTRACT, IFNULL(d.need_dextract,0) NEED_DEXTRACT, IFNULL(d.dental_care_nprosthesis_id,4) NPROSTHESIS, IFNULL(d.permanent_perma,0) PERMANENT_PERMANENT, IFNULL(d.permanent_prost,0) PERMANENT_PROSTHESIS, IFNULL(d.prosthesis_prost,0) PROSTHESIS_PROSTHESIS, concat(IFNULL(d.dental_care_gum_type_id_1,9),IFNULL(d.dental_care_gum_type_id_2,9), IFNULL(d.dental_care_gum_type_id_3,9),IFNULL(d.dental_care_gum_type_id_4,9), IFNULL(d.dental_care_gum_type_id_5,9),IFNULL(d.dental_care_gum_type_id_6,9)) GUM, d.dental_care_school_type_id SCHOOLTYPE, d.dental_care_school_class_type_id CLASS, IFNULL(t.doctor,d.doctor) PROVIDER,  DATE_FORMAT(d.entry_datetime,'%Y%m%d%H%i%s') D_UPDATE, pt.cid CID  FROM dental_care d  LEFT JOIN ovst o ON o.vn=d.vn  LEFT JOIN ovst_seq q ON o.vn=q.vn  LEFT JOIN dtmain t ON d.vn=t.vn LEFT JOIN patient pt on pt.hn=o.hn  WHERE DATE(o.vstdate) BETWEEN '[#DATE_START]' and '[#DATE_END]')as D  GROUP BY SEQ"}