{"NAME":"VILLAGE","LASTUPDATE":"20190718222321","SQLSCRIPT":" SELECT  '[#HOSCODE]' HOSPCODE, IFNULL(v.village_code,'') VID, 0 NTRADITIONAL, COUNT(distinct m.village_priest_id) NMONK, COUNT(distinct rl.village_priest_id) NRELIGIONLEADER, COUNT(distinct nt.village_news_tower_id)  NBROADCAST, COUNT(distinct rt.village_radio_tower_id) NRADIO, COUNT(distinct bhc.village_basis_health_center_id) NPCHC, COUNT(distinct cl.village_healthcare_center_id) NCLINIC, COUNT(distinct ds.village_drug_store_id) NDRUGSTORE, COUNT(distinct n.village_nursery_id) NCHILDCENTER, COUNT(distinct ps.village_school_id) NPSCHOOL, COUNT(distinct ss.village_school_id) NSSCHOOL, COUNT(distinct t.village_temple_id) NTEMPLE, COUNT(distinct rp.village_temple_id) NRELIGIOUSPLACE, COUNT(distinct mkt.village_store_id) NMARKET, COUNT(distinct shp.village_store_id) NSHOP, COUNT(distinct food.village_store_id) NFOODSHOP, COUNT(distinct stall.village_store_id) NSTALL, 0 NRAINTANK, 0 NCHICKENFARM, 0 NPIGFARM, '2' WASTEWATER, '2' GARBAGE, COUNT(distinct fact.village_factory_id) NFACTORY, IFNULL(format(v.latitude, 6),'') LATITUDE, IFNULL(format(v.longitude, 6),'') LONGITUDE, ' ' OUTDATE, 0 NUMACTUALLY, ' ' RISKTYPE, 0 NUMSTATELESS, 0 NEXERCISECLUB, COUNT(distinct vc1.village_club_id) NOLDERLYCLUB, 0 NDISABLECLUB, 0 NNUMBERONECLUB, IFNULL(CAST(v.entry_datetime AS UNSIGNED),DATE_FORMAT(NOW(),'%Y%m%d%H%i%s')) D_UPDATE FROM village v LEFT JOIN village_news_tower nt on v.village_id = nt.village_id LEFT JOIN village_radio_tower rt on v.village_id = rt.village_id LEFT JOIN village_basis_health_center bhc on v.village_id = bhc.village_id LEFT JOIN village_healthcare_center cl on v.village_id = cl.village_id LEFT JOIN village_drug_store ds on v.village_id = ds.village_id LEFT JOIN village_nursery n on v.village_id = n.village_id LEFT JOIN village_school ps on v.village_id = ps.village_id and ps.school_type_id = 2 LEFT JOIN village_school ss on v.village_id = ss.village_id and ss.school_type_id = 3 LEFT JOIN village_temple t on v.village_id = t.village_id and t.village_temple_type_id = 1 LEFT JOIN village_priest m on t.village_temple_id = m.village_temple_id LEFT JOIN village_temple rp on v.village_id = rp.village_id  and rp.village_temple_type_id <> 1 LEFT JOIN village_priest rl on rp.village_temple_id = rl.village_temple_id LEFT JOIN village_store mkt on v.village_id = mkt.village_id  and mkt.village_store_type_id = 3 LEFT JOIN village_store shp on v.village_id = shp.village_id  and shp.village_store_type_id = 1 LEFT JOIN village_store food on v.village_id = food.village_id  and food.village_store_type_id in (2,6) LEFT JOIN village_store stall on v.village_id = stall.village_id  and stall.village_store_type_id = 4 LEFT JOIN village_store ds2 on v.village_id = ds2.village_id  and ds2.village_store_type_id = 5 LEFT JOIN village_factory fact on v.village_id = fact.village_id LEFT JOIN village_club vc1 on v.village_id=vc1.village_id and vc1.club_std_id=1 WHERE v.village_moo <> 0 GROUP BY v.village_id"}