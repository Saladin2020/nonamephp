{"NAME":"ANC","LASTUPDATE":"20190718155308","SQLSCRIPT":" SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',q.pcu_person_id),6) PID, q.seq_id SEQ, DATE_FORMAT(a2.anc_service_date,'%Y%m%d') DATE_SERV, a1.preg_no GRAVIDA, IF(a2.pa_week BETWEEN 1 AND 12,1, IF(a2.pa_week BETWEEN 13 AND 19,2, IF(a2.pa_week BETWEEN 20 AND 25,3, IF(a2.pa_week BETWEEN 26 AND 31,4, IF(a2.pa_week BETWEEN 32 AND 45,5,'' ) ) ) ) ) ANCNO, a2.pa_week GA, IF(a2.service_result='Y',1,IF(a2.service_result='N',2,1)) ANCRESULT, '[#HOSCODE]' ANCPLACE, o.doctor PROVIDER, DATE_FORMAT(a1.last_update,'%Y%m%d%H%i%s') D_UPDATE, p.cid CID  FROM person_anc a1  LEFT JOIN person_anc_service a2 ON a1.person_anc_id = a2.person_anc_id  LEFT JOIN ovst o ON o.vn = a2.vn LEFT JOIN ovst_seq q ON q.vn = a2.vn LEFT JOIN person p on p.person_id=a1.person_id WHERE q.pcu_person_id IS NOT NULL AND (a2.anc_service_type_id=1 OR a2.anc_service_type_id IS NULL)   AND (a2.anc_location_type_id IN (1,0,2) OR a2.anc_location_type_id IS NULL)   AND a2.anc_service_date BETWEEN '[#DATE_START]' and '[#DATE_END]' UNION  SELECT  '[#HOSCODE]' HOSPCODE, RIGHT(CONCAT('000000',a1.person_id),6) PID, '' SEQ, DATE_FORMAT(a2.precare_date,'%Y%m%d') DATE_SERV, a1.preg_no GRAVIDA, IF(a1.preg_no BETWEEN 1 AND 12,1, IF(a1.preg_no BETWEEN 13 AND 19,2, IF(a1.preg_no BETWEEN 20 AND 25,3, IF(a1.preg_no BETWEEN 26 AND 31,4, IF(a1.preg_no BETWEEN 32 AND 45,5,'' ) ) ) ) ) ANCNO, FORMAT(DATEDIFF(a2.precare_date,a1.lmp)/7,0) GA, a2.anc_result ANCRESULT, a2.precare_hospcode ANCPLACE, '' PROVIDER, DATE_FORMAT(a1.last_update,'%Y%m%d%H%i%s') D_UPDATE,  p.cid CID FROM person_anc a1  LEFT JOIN person_anc_other_precare a2 ON a1.person_anc_id = a2.person_anc_id  LEFT JOIN person p on p.person_id=a1.person_id WHERE a2.precare_date BETWEEN '[#DATE_START]' and '[#DATE_END]'  ORDER BY DATE_SERV,SEQ "}