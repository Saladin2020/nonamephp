{"NAME":"REHABILITATION","LASTUPDATE":"20190718221825","SQLSCRIPT":" SELECT  '[#HOSCODE]' HOSPCODE,  RIGHT(CONCAT('000000',o2.pcu_person_id),6) PID, o2.nhso_seq_id SEQ, o1.an AN, IF(o1.an='' OR o1.an IS NULL,'',DATE_FORMAT(o1.vstdate,'%Y%m%d')) DATE_ADMIT, DATE_FORMAT(o1.vstdate,'%Y%m%d') DATE_SERV, DATE_FORMAT(p1.begin_datetime,'%Y%m%d') DATE_START, DATE_FORMAT(p1.end_datetime,'%Y%m%d') DATE_FINISH, p2.f43_rehab_code REHABCODE, p1.at_device_code AT_DEVICE, p1.at_device_qty AT_NO, '[#HOSCODE]' REHABPLACE, p1.doctor PROVIDER, DATE_FORMAT(o2.update_datetime,'%Y%m%d%H%i%s') D_UPDATE, p3.cid CID FROM ovst o1  LEFT JOIN ovst_seq o2 ON o2.vn = o1.vn LEFT JOIN physic_list p1 ON p1.vn = o1.vn  LEFT JOIN physic_items p2 ON p2.physic_items_id = p1.physic_items_id LEFT JOIN patient p3 ON  p3.hn = o1.hn WHERE DATE(o1.vstdate) BETWEEN '[#DATE_START]' and '[#DATE_END]' AND  p2.f43_rehab_code<>'' AND  p2.f43_rehab_code IS NOT NULL UNION  SELECT  '[#HOSCODE]' HOSPCODE,  IF(s.pcu_person_id='' OR s.pcu_person_id IS NULL,v.hn, CAST(s.pcu_person_id AS UNSIGNED)) PID, s.seq_id SEQ, d1.an AN, IF(d1.an='' OR d1.an IS NULL,'',CAST(v.vstdate AS UNSIGNED)) DATE_ADMIT, CAST(v.vstdate AS UNSIGNED) DATE_SERV, CAST(d1.service_date AS UNSIGNED) DATE_START, CAST(d1.finish_date AS UNSIGNED) DATE_FINISH, d2.ovst_rehab_type_id REHABCODE, d2.ovst_rehab_device_type_id AT_DEVICE, d2.ovst_rehab_device_qty AT_NO, '[#HOSCODE]' REHABPLACE, d2.doctor PROVIDER, CAST(d2.entry_datetime AS UNSIGNED) D_UPDATE, pt.cid CID  FROM ovst_rehab d1 LEFT JOIN ovst_rehab_detail d2 ON d1.ovst_rehab_id = d2.ovst_rehab_id LEFT JOIN ovst v ON d1.vn = v.vn LEFT JOIN ovst_seq s ON v.vn = s.vn LEFT JOIN patient pt ON pt.hn=v.hn WHERE 1=1  AND DATE(v.vstdate) BETWEEN '[#DATE_START]' and '[#DATE_END]' order by DATE_SERV,SEQ"}